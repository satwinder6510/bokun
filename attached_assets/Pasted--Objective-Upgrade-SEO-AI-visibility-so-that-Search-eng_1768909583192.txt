üéØ Objective

Upgrade SEO + AI visibility so that:

Search engines and AI crawlers receive fully populated HTML

React SPA behavior remains unchanged

No migration to Next.js or SSR frameworks

Add llm.txt / ai.txt for AI crawler discovery

Fix the current SEO injection flaw without breaking hydration

üö´ Hard Constraints (Do Not Violate)

Do NOT inject SEO HTML inside <div id="root">

Do NOT change client routing (App.tsx)

Do NOT modify booking, Bokun, or pricing logic

Do NOT redesign UI

Do NOT add heavy runtime dependencies

Changes must be additive and reversible

üß† Architecture Context (Known)

HTML shell served by Express

React SPA hydrates into <div id="root"></div>

SEO injection occurs server-side via server/seo/inject.ts

SEO fragments, JSON-LD, sitemaps, feeds already exist

Current flaw: crawlable content is injected inside #root, which React overwrites

‚úÖ Phase 1 ‚Äî Fix SEO injection safely (CRITICAL)
Replace body injection strategy

Stop using the existing injectIntoBody() that injects inside #root.

Implement a new function in server/seo/inject.ts:

Inject crawlable HTML above <div id="root"></div>

Keep #root empty for React hydration

Add <noscript> fallback

Hide SEO content for humans, show for bots

Required behavior

Bots see visible SEO text + links

Humans do not see duplicate content

React hydration remains unaffected

Implementation requirements

Use a dedicated container (e.g. <div id="seo-content">)

Insert before the root div

Detect bots via User-Agent (Googlebot, Bingbot, GPTBot, ClaudeBot, Perplexity, etc.)

Do NOT inject inside #root

‚úÖ Phase 2 ‚Äî Ensure complete <head> metadata per route

For all indexable routes:

/

/packages

/destinations/:slug

/Holidays/:country/:slug

/tour/:id

Ensure injected <head> always includes:

<title>

<meta name="description">

<link rel="canonical">

OpenGraph tags

Twitter tags

JSON-LD scripts

‚ö†Ô∏è Do NOT remove existing tags unless you are guaranteed to re-insert them.

‚úÖ Phase 3 ‚Äî Structured data (JSON-LD)

Using existing generators:

Organization (sitewide)

BreadcrumbList (all detail/list pages)

Package / Tour entities (no fake ratings)

FAQPage where applicable

Inject JSON-LD into <head> only.

‚úÖ Phase 4 ‚Äî Add AI crawler support (NEW)
Implement:

GET /llm.txt

GET /ai.txt

Rules:

Serve as text/plain

Fast, static output (no DB calls)

Registered inside registerSeoRoutes(app)

Content:

Declare crawl permissions

Point to:

/sitemap.xml

/feeds/packages.json

/feeds/destinations.json

/feeds/tours.json

Allow summarization and indexing

Require attribution

Prefer PUBLIC_BASE_URL env var for absolute URLs.

‚úÖ Phase 5 ‚Äî Indexation control

Apply server-side rules:

noindex,follow for:

/ai-search

query-param heavy URLs

internal/debug routes

Canonicalize clean URLs (strip utm_*, tracking params)

‚úÖ Phase 6 ‚Äî Internal linking for crawl depth

Ensure SEO fragments contain:

H1

150‚Äì400 words of descriptive text

Real <a href> links to:

related destinations

related packages

country/category pages

Breadcrumb links

No JS-only navigation in SEO fragments.

üß™ Mandatory Tests (Must Pass)

SPA loads normally in browser

No hydration warnings

Bokun tour pages still function

curl -A "Googlebot" returns:

visible SEO text

metadata

JSON-LD

view-source: shows content outside #root

/llm.txt, /ai.txt, /robots.txt, /sitemap.xml all return 200

üì¶ Deliverables

Code changes:

new SEO body injection method

safe head injection

llm.txt + ai.txt routes

noindex/canonical rules

Short documentation:

how SEO injection works

how to add new route fragments

how to test bot rendering

üîë Non-Negotiable Rule (MOST IMPORTANT)

Never inject SEO content inside <div id="root">.
React owns that node and will destroy your SEO output.