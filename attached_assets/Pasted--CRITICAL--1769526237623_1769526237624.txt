  CRITICAL                                                                                                                                                                                                           ┌─────────────────────────────────┬───────────────────────────────────────────────────┬───────────────────────────────────────────────────────────────────────────────────────────────────┐
  │              Issue              │                     Location                      │                                               Risk                                                │                        ├─────────────────────────────────┼───────────────────────────────────────────────────┼───────────────────────────────────────────────────────────────────────────────────────────────────┤
  │ XSS via dangerouslySetInnerHTML │ TourDetail.tsx, PackageDetail.tsx, PreviewFAQ.tsx │ HTML from Bokun API/DB rendered without sanitization                                              │
  ├─────────────────────────────────┼───────────────────────────────────────────────────┼───────────────────────────────────────────────────────────────────────────────────────────────────┤
  │ Missing auth on admin endpoints │ routes.ts                                         │ FAQ, Blog, Reviews POST/PATCH/DELETE not protected - comment says "add proper API authentication" │
  ├─────────────────────────────────┼───────────────────────────────────────────────────┼───────────────────────────────────────────────────────────────────────────────────────────────────┤
  │ Session storage in memory       │ routes.ts:48                                      │ Pending 2FA sessions stored in Map, lost on restart                                               │
  └─────────────────────────────────┴───────────────────────────────────────────────────┴───────────────────────────────────────────────────────────────────────────────────────────────────┘
  HIGH
  ┌───────────────────────────────┬─────────────────────────────────────────┐
  │             Issue             │                Location                 │
  ├───────────────────────────────┼─────────────────────────────────────────┤
  │ 40+ uses of any type          │ routes.ts                               │
  ├───────────────────────────────┼─────────────────────────────────────────┤
  │ No CSRF protection            │ All state-changing endpoints            │
  ├───────────────────────────────┼─────────────────────────────────────────┤
  │ Session token in localStorage │ AdminAuthContext.tsx (XSS can steal it) │
  ├───────────────────────────────┼─────────────────────────────────────────┤
  │ Weak password policy          │ Only 8 char minimum                     │
  └───────────────────────────────┴─────────────────────────────────────────┘
  MEDIUM
  ┌────────────────────────────────────┬─────────────────────────┐
  │               Issue                │         Impact          │
  ├────────────────────────────────────┼─────────────────────────┤
  │ routes.ts is 9,825 lines           │ Unmaintainable monolith │
  ├────────────────────────────────────┼─────────────────────────┤
  │ Missing DB indexes on foreign keys │ Slow queries            │
  ├────────────────────────────────────┼─────────────────────────┤
  │ No rate limiting                   │ Brute force vulnerable  │
  ├────────────────────────────────────┼─────────────────────────┤
  │ Generic error messages             │ Hard to debug           │
  └────────────────────────────────────┴─────────────────────────┘
  LOW
  ┌──────────────────────────────────────┐
  │                Issue                 │
  ├──────────────────────────────────────┤
  │ No tests                             │
  ├──────────────────────────────────────┤
  │ Dead code (PackageDetailOld.tsx)     │
  ├──────────────────────────────────────┤
  │ No caching                           │
  ├──────────────────────────────────────┤
  │ Deprecated 2FA endpoint still exists │
  └──────────────────────────────────────┘
  ---
  Priority fixes:
  1. Add verifyAdminSession middleware to all admin POST/PATCH/DELETE endpoints
  2. Sanitize HTML before dangerouslySetInnerHTML (use DOMPurify)
  3. Move session tokens to HTTP-only cookies
